{% comment %}
  Simple Header Template with Mobile Drawer functionality and schema support for a menu.
{% endcomment %}

<!-- Styles -->
<style>
  /* Basic header styling */
  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 1.5rem;
    background: #fff;
    border-bottom: 1px solid #eee;
  }
  .header__inner {
    display: flex;
    align-items: center;
  }
  .logo img,
  .logo span {
    max-height: 50px;
  }
  .drawer-toggle {
    background: none;
    border: none;
    font-size: 1rem;
    cursor: pointer;
    margin-right: 1rem;
  }
  .cart {
    position: relative;
    text-decoration: none;
    color: inherit;
  }
  .cart-count {
    position: absolute;
    top: -0.5rem;
    right: -0.5rem;
    background: #e60023;
    color: #fff;
    border-radius: 50%;
    padding: 0.2rem 0.5rem;
    font-size: 0.75rem;
  }
  /* Mobile drawer styles */
  .mobile-drawer {
    background: #fff;
    border-top: 1px solid #eee;
    padding: 1rem;
  }
  .mobile-drawer ul {
    list-style: none;
    margin: 0;
    padding: 0;
  }
  .mobile-drawer li {
    margin-bottom: 0.5rem;
  }
  .mobile-drawer a {
    text-decoration: none;
    color: #333;
  }
</style>

<!-- Header Markup -->
<header class="header">
  <div class="header__inner">
    <!-- Logo -->
    <a href="{{ routes.root_url }}" class="logo">
      {% if settings.logo != blank %}
        <img src="{{ settings.logo | image_url: width: 300 }}" alt="{{ shop.name }}">
      {% else %}
        <span>{{ shop.name }}</span>
      {% endif %}
    </a>
  </div>

  <div class="header__inner">
    <!-- Mobile drawer toggle button (only shown if a menu is selected) -->
    {% if settings.menu != blank %}
      <button class="drawer-toggle" aria-controls="mobile-drawer" aria-expanded="false">
        Menu
      </button>
    {% endif %}

    <!-- Cart Icon -->
    <a href="{{ routes.cart_url }}" class="cart">
      <span>Cart</span>
      {% if cart.item_count > 0 %}
        <span class="cart-count">{{ cart.item_count }}</span>
      {% endif %}
    </a>
  </div>
</header>

<!-- Mobile Drawer Navigation (only if a menu is set and available) -->
{% if settings.menu != blank %}
  {% assign current_menu = linklists[settings.menu] %}
  {% if current_menu %}
    <nav id="mobile-drawer" class="mobile-drawer" hidden>
      <ul>
        {% for link in current_menu.links %}
          <li>
            <a href="{{ link.url }}">{{ link.title }}</a>
          </li>
        {% endfor %}
      </ul>
    </nav>
  {% endif %}
{% endif %}

<!-- JavaScript to Toggle the Mobile Drawer -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var drawerToggle = document.querySelector('.drawer-toggle');
    var mobileDrawer = document.getElementById('mobile-drawer');

    if (drawerToggle && mobileDrawer) {
      drawerToggle.addEventListener('click', function() {
        // Toggle the hidden attribute on the mobile drawer
        var isOpen = !mobileDrawer.hasAttribute('hidden');
        if (isOpen) {
          mobileDrawer.setAttribute('hidden', '');
          drawerToggle.setAttribute('aria-expanded', 'false');
        } else {
          mobileDrawer.removeAttribute('hidden');
          drawerToggle.setAttribute('aria-expanded', 'true');
        }
      });
    }
  });
</script>

<!-- Schema -->
{% schema %}
{
  "name": "Simple Header",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
     {
      "type": "link_list",
      "id": "menu",
      "default": "main-menu",
      "label": "t:sections.header.settings.menu.label"
    },
  ],
  "presets": [
    {
      "name": "Simple Header"
    }
  ]
}
{% endschema %}
